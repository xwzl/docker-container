input {
 # tcp {
 #   mode => "server"
 #   host => "0.0.0.0"
 #   port => 5044
 #   codec => json_lines
 #}
   # 来源beats
  beats {
      # 端口
      port => "5044"
  }
}

filter {
        grok {
                match => { "message" => "%{IPV4:clientIp} %{IPV4:host} %{TIMESTAMP_ISO8601:timeStamp}\s{0,10}%{LOGLEVEL:level}\s{0,10}%{NUMBER:pid}\s{0,10}\---\s{0,10}\[%{USER:appName}\]\s{0,10}\[\s{0,10}%{USER:threadName}\]\s{0,10}\[TID:%{USERNAME:tid}\] %{JAVACLASS:class}\s{0,10}:%{JAVALOGMESSAGE:msg}" }	#在这里引用
        }
        mutate {
            remove_field => ["file","agent","containerized","host","@version"]
        }
        if [appName] == '' {
            drop{}
        }
}


output {
  elasticsearch {
    hosts => "1.15.19.68:9200"
    user => "elastic"
    password => "elastic"
    index => "logstash-%{+YYYY.MM.dd}"
  }
 # 控制台打印
  stdout {codec => rubydebug}
}
